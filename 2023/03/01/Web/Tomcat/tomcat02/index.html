

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/default.ico">
  <link rel="icon" href="/img/default.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="陈怀森">
  <meta name="keywords" content="">
  
    <meta name="description" content="1.Tomcat安装及配置1.1 Tomcat安装官网：https:&#x2F;&#x2F;tomcat.apache.org&#x2F;download-90.cgi [root@node10 ~]# wget https:&#x2F;&#x2F;dlcdn.apache.org&#x2F;tomcat&#x2F;tomcat-9&#x2F;v9.0.72&#x2F;bin&#x2F;apache-tomcat-9.0.72.tar.gz [root@node10 ~]# tar -xvf a">
<meta property="og:type" content="article">
<meta property="og:title" content="(2).Tomcat安装及配置">
<meta property="og:url" content="http://chsblogs.com/2023/03/01/Web/Tomcat/tomcat02/index.html">
<meta property="og:site_name" content="陈怀森の学习笔记">
<meta property="og:description" content="1.Tomcat安装及配置1.1 Tomcat安装官网：https:&#x2F;&#x2F;tomcat.apache.org&#x2F;download-90.cgi [root@node10 ~]# wget https:&#x2F;&#x2F;dlcdn.apache.org&#x2F;tomcat&#x2F;tomcat-9&#x2F;v9.0.72&#x2F;bin&#x2F;apache-tomcat-9.0.72.tar.gz [root@node10 ~]# tar -xvf a">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://chsblogs.com/2023/03/01/Web/Tomcat/tomcat02/image-20230301193155195.png">
<meta property="article:published_time" content="2023-03-01T01:28:32.000Z">
<meta property="article:modified_time" content="2023-03-14T17:51:01.407Z">
<meta property="article:author" content="陈怀森">
<meta property="article:tag" content="Tomcat">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://chsblogs.com/2023/03/01/Web/Tomcat/tomcat02/image-20230301193155195.png">
  
  
  
  <title>(2).Tomcat安装及配置 - 陈怀森の学习笔记</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"chsblogs.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"§"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"SHELL"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"left","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":6},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>陈怀森 の 学习笔记</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="(2).Tomcat安装及配置"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-03-01 09:28" pubdate>
          2023年3月1日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          20k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          14 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="padding-left: 2rem; margin-right: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">(2).Tomcat安装及配置</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="1-Tomcat安装及配置"><a href="#1-Tomcat安装及配置" class="headerlink" title="1.Tomcat安装及配置"></a>1.Tomcat安装及配置</h1><h2 id="1-1-Tomcat安装"><a href="#1-1-Tomcat安装" class="headerlink" title="1.1 Tomcat安装"></a>1.1 Tomcat安装</h2><p>官网：<a target="_blank" rel="noopener" href="https://tomcat.apache.org/download-90.cgi">https://tomcat.apache.org/download-90.cgi</a></p>
<figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># wget https://dlcdn.apache.org/tomcat/tomcat-9/v9.0.72/bin/apache-tomcat-9.0.72.tar.gz</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># tar -xvf apache-tomcat-9.0.72.tar.gz -C /usr/local/</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># cd /usr/local/</span>
<span class="token punctuation">[</span>root@node10 local<span class="token punctuation">]</span><span class="token comment"># ln -s apache-tomcat-9.0.72/ tomcat</span>
<span class="token punctuation">[</span>root@node10 local<span class="token punctuation">]</span><span class="token comment"># echo 'PATH=/usr/local/tomcat/bin:$PATH' > /etc/profile.d/tomcat.sh</span>
<span class="token punctuation">[</span>root@node10 local<span class="token punctuation">]</span><span class="token comment"># . /etc/profile.d/tomcat.sh</span>

<span class="token comment">#启动tomcat</span>
<span class="token comment">#或者使用：[root@node10 local]# catalina.sh start</span>
<span class="token punctuation">[</span>root@node10 local<span class="token punctuation">]</span><span class="token comment"># startup.sh </span>
Using CATALINA_BASE:   /usr/local/tomcat
Using CATALINA_HOME:   /usr/local/tomcat
Using CATALINA_TMPDIR: /usr/local/tomcat/temp
Using JRE_HOME:        /usr/local/jdk/jre
Using CLASSPATH:       /usr/local/tomcat/bin/bootstrap.jar:/usr/local/tomcat/bin/tomcat-juli.jar
Using CATALINA_OPTS:   
Tomcat started.

<span class="token comment">#关闭tomcat</span>
<span class="token comment">#或者使用：[root@node10 local]# catalina.sh stop</span>
<span class="token punctuation">[</span>root@node10 local<span class="token punctuation">]</span><span class="token comment"># shutdown.sh </span>
Using CATALINA_BASE:   /usr/local/tomcat
Using CATALINA_HOME:   /usr/local/tomcat
Using CATALINA_TMPDIR: /usr/local/tomcat/temp
Using JRE_HOME:        /usr/local/jdk/jre
Using CLASSPATH:       /usr/local/tomcat/bin/bootstrap.jar:/usr/local/tomcat/bin/tomcat-juli.jar
Using CATALINA_OPTS: 

<span class="token comment">#配置tomcat自启动的service文件</span>
</code></pre></div></figure>



<p><strong>配置tomcat自启动的service文件：</strong></p>
<figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#创建tomcat用户</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># useradd -r -s /sbin/nologin tomcat</span>

<span class="token comment">#准备service文件中相关环境文件</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim /usr/local/tomcat/conf/tomcat.conf</span>
<span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/usr/local/jdk

<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># chown -R tomcat.tomcat /usr/local/tomcat/</span>

<span class="token comment">#创建tomcat.service文件</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim /lib/systemd/system/tomcat.service</span>
<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Tomcat
<span class="token comment">#After=syslog.target network.target remote-fs.target nss-lookup.target</span>
<span class="token assign-left variable">After</span><span class="token operator">=</span>syslog.target network.target
<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>forking
<span class="token assign-left variable">EnvironmentFile</span><span class="token operator">=</span>/usr/local/tomcat/conf/tomcat.conf
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/local/tomcat/bin/startup.sh
<span class="token assign-left variable">ExecStop</span><span class="token operator">=</span>/usr/local/tomcat/bin/shutdown.sh
<span class="token assign-left variable">PrivateTmp</span><span class="token operator">=</span>true
<span class="token assign-left variable">User</span><span class="token operator">=</span>tomcat
<span class="token assign-left variable">Group</span><span class="token operator">=</span>tomcat
<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target

<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># systemctl daemon-reload</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># systemctl enable --now tomcat</span></code></pre></div></figure>



<p><strong>一键安装 tomcat脚本：</strong></p>
<figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim install_tomcat.sh</span>
<span class="token comment">#!/bin/bash</span>
<span class="token assign-left variable">DIR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>
<span class="token assign-left variable">JDK_FILE</span><span class="token operator">=</span><span class="token string">"jdk-8u341-linux-x64.tar.gz"</span>
<span class="token assign-left variable">TOMCAT_FILE</span><span class="token operator">=</span><span class="token string">"apache-tomcat-9.0.72.tar.gz"</span>
<span class="token assign-left variable">JDK_DIR</span><span class="token operator">=</span><span class="token string">"/usr/local"</span>
<span class="token assign-left variable">TOMCAT_DIR</span><span class="token operator">=</span><span class="token string">"/usr/local"</span>

<span class="token function-name function">color</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
<span class="token assign-left variable">RES_COL</span><span class="token operator">=</span><span class="token number">60</span>
<span class="token assign-left variable">MOVE_TO_COL</span><span class="token operator">=</span><span class="token string">"echo -en <span class="token entity" title="\\">\\</span>033[<span class="token variable">$&#123;RES_COL&#125;</span>G"</span>
<span class="token assign-left variable">SETCOLOR_SUCCESS</span><span class="token operator">=</span><span class="token string">"echo -en <span class="token entity" title="\\">\\</span>033[1;32m"</span>
<span class="token assign-left variable">SETCOLOR_FAILURE</span><span class="token operator">=</span><span class="token string">"echo -en <span class="token entity" title="\\">\\</span>033[1;31m"</span>
<span class="token assign-left variable">SETCOLOR_WARNING</span><span class="token operator">=</span><span class="token string">"echo -en <span class="token entity" title="\\">\\</span>033[1;33m"</span>
<span class="token assign-left variable">SETCOLOR_NORMAL</span><span class="token operator">=</span><span class="token string">"echo -en <span class="token entity" title="\E">\E</span>[0m"</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"<span class="token variable">$2</span>"</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$MOVE_TO_COL</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"["</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$1</span> <span class="token operator">=</span> <span class="token string">"success"</span> <span class="token parameter variable">-o</span> <span class="token variable">$1</span> <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token keyword">then</span>
  <span class="token variable">$&#123;SETCOLOR_SUCCESS&#125;</span>
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> $<span class="token string">" OK "</span>
<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$1</span> <span class="token operator">=</span> <span class="token string">"failure"</span> <span class="token parameter variable">-o</span> <span class="token variable">$1</span> <span class="token operator">=</span> <span class="token string">"1"</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token keyword">then</span>
  <span class="token variable">$&#123;SETCOLOR_FAILURE&#125;</span>
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> $<span class="token string">"FAILED"</span>
<span class="token keyword">else</span>
  <span class="token variable">$&#123;SETCOLOR_WARNING&#125;</span>
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> $<span class="token string">"WARNING"</span>
<span class="token keyword">fi</span>
  <span class="token variable">$&#123;SETCOLOR_NORMAL&#125;</span>
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"]"</span>
  <span class="token builtin class-name">echo</span>
<span class="token punctuation">&#125;</span>

<span class="token function-name function">install_jdk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token keyword">if</span> <span class="token operator">!</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">$DIR</span>/<span class="token variable">$JDK_FILE</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
  color <span class="token number">1</span> <span class="token string">"<span class="token variable">$JDK_FILE</span> 文件不存在"</span>
  <span class="token builtin class-name">exit</span><span class="token punctuation">;</span>
<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token parameter variable">-d</span> <span class="token variable">$JDK_DIR</span>/jdk <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
  color <span class="token number">1</span> <span class="token string">"JDK 已经安装"</span>
  <span class="token builtin class-name">exit</span>
<span class="token keyword">else</span>
  <span class="token punctuation">[</span> <span class="token parameter variable">-d</span> <span class="token string">"<span class="token variable">$JDK_DIR</span>"</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token function">mkdir</span> <span class="token parameter variable">-pv</span> <span class="token variable">$JDK_DIR</span>
<span class="token keyword">fi</span>

<span class="token function">tar</span> xvf <span class="token variable">$DIR</span>/<span class="token variable">$JDK_FILE</span> <span class="token parameter variable">-C</span> <span class="token variable">$JDK_DIR</span>
<span class="token builtin class-name">cd</span> <span class="token variable">$JDK_DIR</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ln</span> <span class="token parameter variable">-s</span> jdk1.8.* jdk
<span class="token function">cat</span> <span class="token operator">></span> /etc/profile.d/jdk.sh <span class="token operator">&lt;&lt;</span><span class="token string">EOF
export JAVA_HOME=<span class="token variable">$JDK_DIR</span>/jdk
export JRE_HOME=\<span class="token variable">$JAVA_HOME</span>/jre
export CLASSPATH=\<span class="token variable">$JAVA_HOME</span>/lib/:\<span class="token variable">$JRE_HOME</span>/lib/
export PATH=\<span class="token environment constant">$PATH</span>:\<span class="token variable">$JAVA_HOME</span>/bin
EOF</span>
<span class="token builtin class-name">.</span> /etc/profile.d/jdk.sh
<span class="token function">java</span> <span class="token parameter variable">-version</span> <span class="token operator">&amp;&amp;</span> color <span class="token number">0</span> <span class="token string">"JDK 安装完成"</span> <span class="token operator">||</span> <span class="token punctuation">&#123;</span> color <span class="token number">1</span> <span class="token string">"JDK 安装失败"</span> <span class="token punctuation">;</span> <span class="token builtin class-name">exit</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token function-name function">install_tomcat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token keyword">if</span> <span class="token operator">!</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">$DIR</span>/<span class="token variable">$TOMCAT_FILE</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
  color <span class="token number">1</span> <span class="token string">"<span class="token variable">$TOMCAT_FILE</span> 文件不存在"</span>
  <span class="token builtin class-name">exit</span><span class="token punctuation">;</span>
<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token parameter variable">-d</span> <span class="token variable">$TOMCAT_DIR</span>/tomcat <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
  color <span class="token number">1</span> <span class="token string">"TOMCAT 已经安装"</span>
  <span class="token builtin class-name">exit</span>
<span class="token keyword">else</span>
  <span class="token punctuation">[</span> <span class="token parameter variable">-d</span> <span class="token string">"<span class="token variable">$TOMCAT_DIR</span>"</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token function">mkdir</span> <span class="token parameter variable">-pv</span> <span class="token variable">$TOMCAT_DIR</span>
<span class="token keyword">fi</span>
<span class="token function">tar</span> xf <span class="token variable">$DIR</span>/<span class="token variable">$TOMCAT_FILE</span> <span class="token parameter variable">-C</span> <span class="token variable">$TOMCAT_DIR</span>
<span class="token builtin class-name">cd</span> <span class="token variable">$TOMCAT_DIR</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ln</span> <span class="token parameter variable">-s</span> apache-tomcat-*/ tomcat
<span class="token builtin class-name">echo</span> <span class="token string">"PATH=<span class="token variable">$TOMCAT_DIR</span>/tomcat/bin:"</span><span class="token string">'$PATH'</span> <span class="token operator">></span> /etc/profile.d/tomcat.sh
<span class="token function">id</span> tomcat <span class="token operator">&amp;></span> /dev/null <span class="token operator">||</span> <span class="token function">useradd</span> <span class="token parameter variable">-r</span> <span class="token parameter variable">-s</span> /sbin/nologin tomcat
<span class="token function">cat</span> <span class="token operator">></span> <span class="token variable">$TOMCAT_DIR</span>/tomcat/conf/tomcat.conf <span class="token operator">&lt;&lt;</span><span class="token string">EOF
JAVA_HOME=<span class="token variable">$JDK_DIR</span>/jdk
EOF</span>

<span class="token function">chown</span> <span class="token parameter variable">-R</span> tomcat.tomcat <span class="token variable">$TOMCAT_DIR</span>/tomcat/
<span class="token function">cat</span> <span class="token operator">></span> /lib/systemd/system/tomcat.service <span class="token operator">&lt;&lt;</span><span class="token string">EOF
[Unit]
Description=Tomcat
#After=syslog.target network.target remote-fs.target nss-lookup.target
After=syslog.target network.target
[Service]
Type=forking
EnvironmentFile=<span class="token variable">$TOMCAT_DIR</span>/tomcat/conf/tomcat.conf
ExecStart=<span class="token variable">$TOMCAT_DIR</span>/tomcat/bin/startup.sh
ExecStop=<span class="token variable">$TOMCAT_DIR</span>/tomcat/bin/shutdown.sh
RestartSec=3
PrivateTmp=true
User=tomcat
Group=tomcat

[Install]
WantedBy=multi-user.target
EOF</span>

systemctl daemon-reload
systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> tomcat.service <span class="token operator">&amp;></span> /dev/null
systemctl is-active tomcat.service <span class="token operator">&amp;></span> /dev/null <span class="token operator">&amp;&amp;</span> color <span class="token number">0</span> <span class="token string">"TOMCAT 安装完成"</span> <span class="token operator">||</span> <span class="token punctuation">&#123;</span> color <span class="token number">1</span> <span class="token string">"TOMCAT 安装失败"</span> <span class="token punctuation">;</span> <span class="token builtin class-name">exit</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

install_jdk
install_tomcat

<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># ls</span>
anaconda-ks.cfg  apache-tomcat-9.0.72.tar.gz  install_tomcat.sh  jdk-8u341-linux-x64.tar.gz
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># chmod +x install_tomcat.sh</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># sh install_tomcat.sh</span></code></pre></div></figure>



<h2 id="1-2-Tomcat配置"><a href="#1-2-Tomcat配置" class="headerlink" title="1.2 Tomcat配置"></a>1.2 Tomcat配置</h2><h3 id="1-2-1-Tomcat目录结构"><a href="#1-2-1-Tomcat目录结构" class="headerlink" title="1.2.1 Tomcat目录结构"></a>1.2.1 Tomcat目录结构</h3><figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@node10 tomcat<span class="token punctuation">]</span><span class="token comment"># tree -L 1</span>
<span class="token builtin class-name">.</span>
├── bin <span class="token comment">#服务启动、停止等相关程序和文件</span>
├── BUILDING.txt
├── conf <span class="token comment">#配置文件</span>
├── CONTRIBUTING.md
├── lib <span class="token comment">#库目录</span>
├── LICENSE
├── logs <span class="token comment">#日志目录</span>
├── NOTICE
├── README.md
├── RELEASE-NOTES
├── RUNNING.txt
├── temp
├── webapps <span class="token comment">#应用程序，应用部署目录</span>
└── work <span class="token comment">#jsp编译后的结果文件，建议提前预热访问</span>

<span class="token number">7</span> directories, <span class="token number">7</span> files

<span class="token comment">#当访问后，work目录中生成新文件，tomcat会自动的将jsp文件生成java源文件，再编译成class文件</span>
<span class="token punctuation">[</span>root@node10 tomcat<span class="token punctuation">]</span><span class="token comment"># tree work/Catalina/localhost/</span>
work/Catalina/localhost/
├── docs
├── examples
├── host-manager
├── manager
└── ROOT
    └── org
        └── apache
            └── jsp
                ├── index_jsp.class <span class="token comment">#字节码文件</span>
                └── index_jsp.java  <span class="token comment">#servlet文件</span>

<span class="token number">8</span> directories, <span class="token number">2</span> files</code></pre></div></figure>



<h3 id="1-2-2-Tomcat配置文件"><a href="#1-2-2-Tomcat配置文件" class="headerlink" title="1.2.2 Tomcat配置文件"></a>1.2.2 Tomcat配置文件</h3><p>官方帮助文档：<a target="_blank" rel="noopener" href="https://tomcat.apache.org/tomcat-9.0-doc/index.html">https://tomcat.apache.org/tomcat-9.0-doc/index.html</a></p>
<figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@node10 tomcat<span class="token punctuation">]</span><span class="token comment"># tree conf/</span>
conf/
├── Catalina
│   └── localhost
├── catalina.policy <span class="token comment">#当使用security选项启动tomcat时，用于为tomcat设置安全策略</span>
├── catalina.properties <span class="token comment">#Tomcat 环境变量的配置，用于设定类加载器路径，以及一些与JVM调优相关参数。</span>
├── context.xml <span class="token comment">#用于定义所有web应用均需加载的Context配置，此文件为所有的webapps提供默认配置，每个web应用也可以使用自已专用的配置，它通常由专用的配置文件context.xml来定义，其存放位置为WEB-INF/目录中,覆盖全局的文件。</span>
├── jaspic-providers.xml
├── jaspic-providers.xsd
├── logging.properties <span class="token comment">#Tomcat 日志系统相关的配置，可以修改日志级别和日志路径等。</span>
├── server.xml <span class="token comment">#主配置文件。</span>
├── tomcat.conf
├── tomcat-users.xml <span class="token comment">#用户认证的账号和密码文件。</span>
├── tomcat-users.xsd
└── web.xml <span class="token comment">#每个webapp只有“部署”后才能被访问，它的部署方式通常由web.xml进行定义，其存放位置为WEB-INF/目录中；此文件为所有的webapps提供默认部署相关的配置,每个web应用也可以使用专用配置文件,来覆盖全局文件。</span>

<span class="token number">2</span> directories, <span class="token number">11</span> files</code></pre></div></figure>



<p><strong>日志文件：</strong></p>
<figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#参考文档：https://cwiki.apache.org/confluence/display/TOMCAT/Logging</span>
<span class="token comment">#日志格式：https://tomcat.apache.org/tomcat-9.0-doc/config/valve.html#Access_Logging</span>
%a - Remote IP address
%A - Local IP address
%b - Bytes sent, excluding HTTP headers, or <span class="token string">'-'</span> <span class="token keyword">if</span> zero
%B - Bytes sent, excluding HTTP headers
%h - Remote <span class="token function">host</span> name <span class="token punctuation">(</span>or IP address <span class="token keyword">if</span> enableLookups <span class="token keyword">for</span> the connector is
<span class="token boolean">false</span><span class="token punctuation">)</span>
%H - Request protocol
%l - Remote logical username from identd <span class="token punctuation">(</span>always returns <span class="token string">'-'</span><span class="token punctuation">)</span>
%m - Request method <span class="token punctuation">(</span>GET, POST, etc.<span class="token punctuation">)</span>
%p - Local port on <span class="token function">which</span> this request was received. See also %<span class="token punctuation">&#123;</span>xxx<span class="token punctuation">&#125;</span>p below.
%q - Query string <span class="token punctuation">(</span>prepended with a <span class="token string">'?'</span> <span class="token keyword">if</span> it exists<span class="token punctuation">)</span>
%r - First line of the request <span class="token punctuation">(</span>method and request URI<span class="token punctuation">)</span>
%s - HTTP status code of the response
%S - User session ID
%t - Date and time, <span class="token keyword">in</span> Common Log Format
%u - Remote user that was authenticated <span class="token punctuation">(</span>if any<span class="token punctuation">)</span>, <span class="token keyword">else</span> <span class="token string">'-'</span>
%U - Requested URL path
%v - Local server name
%D - Time taken to process the request <span class="token keyword">in</span> millis. Note: In httpd %D is
microseconds. Behaviour will be aligned to httpd <span class="token keyword">in</span> Tomcat <span class="token number">10</span> onwards.
%T - Time taken to process the request, <span class="token keyword">in</span> seconds. Note: This value has
millisecond resolution whereas <span class="token keyword">in</span> httpd it has second resolution. Behaviour will
be align to httpd <span class="token keyword">in</span> Tomcat <span class="token number">10</span> onwards.
%F - Time taken to commit the response, <span class="token keyword">in</span> millis
%I - Current request thread name <span class="token punctuation">(</span>can compare later with stacktraces<span class="token punctuation">)</span>
%X - Connection status when response is completed:
X <span class="token operator">=</span> Connection aborted before the response completed.
+ <span class="token operator">=</span> Connection may be kept alive after the response is sent.
- <span class="token operator">=</span> Connection will be closed after the response is sent.
There is also support to <span class="token function">write</span> information incoming or outgoing headers, cookies,
session or request attributes and special timestamp formats. It is modeled after
the Apache HTTP Server log configuration syntax. Each of them can be used
multiple <span class="token builtin class-name">times</span> with different xxx keys:
%<span class="token punctuation">&#123;</span>xxx<span class="token punctuation">&#125;</span>i <span class="token function">write</span> value of incoming header with name xxx
%<span class="token punctuation">&#123;</span>xxx<span class="token punctuation">&#125;</span>o <span class="token function">write</span> value of outgoing header with name xxx
%<span class="token punctuation">&#123;</span>xxx<span class="token punctuation">&#125;</span>c <span class="token function">write</span> value of cookie with name xxx
%<span class="token punctuation">&#123;</span>xxx<span class="token punctuation">&#125;</span>r <span class="token function">write</span> value of ServletRequest attribute with name xxx
%<span class="token punctuation">&#123;</span>xxx<span class="token punctuation">&#125;</span>s <span class="token function">write</span> value of HttpSession attribute with name xxx
%<span class="token punctuation">&#123;</span>xxx<span class="token punctuation">&#125;</span>p <span class="token function">write</span> <span class="token builtin class-name">local</span> <span class="token punctuation">(</span>server<span class="token punctuation">)</span> port <span class="token punctuation">(</span>xxx<span class="token operator">==</span>local<span class="token punctuation">)</span> or remote <span class="token punctuation">(</span>client<span class="token punctuation">)</span> port
<span class="token punctuation">(</span>xxx<span class="token operator">=</span>remote<span class="token punctuation">)</span>
%<span class="token punctuation">&#123;</span>xxx<span class="token punctuation">&#125;</span>t <span class="token function">write</span> timestamp at the end of the request formatted using the enhanced
SimpleDateFormat pattern xxx


<span class="token comment">#tomcat中的日志文件</span>
<span class="token punctuation">[</span>root@node10 conf<span class="token punctuation">]</span><span class="token comment"># cat /usr/local/tomcat/conf/logging.properties</span>

<span class="token comment">#tomcat的访问日志格式</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>-- Access log processes all example.
             Documentation at: /docs/config/valve.html
             Note: The pattern used is equivalent to using <span class="token assign-left variable">pattern</span><span class="token operator">=</span><span class="token string">"common"</span> --<span class="token operator">></span>
        <span class="token operator">&lt;</span>Valve <span class="token assign-left variable">className</span><span class="token operator">=</span><span class="token string">"org.apache.catalina.valves.AccessLogValve"</span> <span class="token assign-left variable">directory</span><span class="token operator">=</span><span class="token string">"logs"</span>
               <span class="token assign-left variable">prefix</span><span class="token operator">=</span><span class="token string">"localhost_access_log"</span> <span class="token assign-left variable">suffix</span><span class="token operator">=</span><span class="token string">".txt"</span>
               <span class="token assign-left variable">pattern</span><span class="token operator">=</span><span class="token string">"%h %l %u %t &amp;quot;%r&amp;quot; %s %b"</span> /<span class="token operator">></span>

<span class="token comment">#查看访问日志</span>
<span class="token punctuation">[</span>root@node10 conf<span class="token punctuation">]</span><span class="token comment"># cat /usr/local/tomcat/logs/localhost_access_log.2023-03-01.txt </span>
<span class="token number">192.168</span>.1.200 - - <span class="token punctuation">[</span>01/Mar/2023:14:32:07 +0800<span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> <span class="token number">200</span> <span class="token number">11230</span>
<span class="token number">192.168</span>.1.200 - - <span class="token punctuation">[</span>01/Mar/2023:14:32:07 +0800<span class="token punctuation">]</span> <span class="token string">"GET /tomcat.svg HTTP/1.1"</span> <span class="token number">200</span> <span class="token number">67795</span>
<span class="token number">192.168</span>.1.200 - - <span class="token punctuation">[</span>01/Mar/2023:14:32:07 +0800<span class="token punctuation">]</span> <span class="token string">"GET /tomcat.css HTTP/1.1"</span> <span class="token number">200</span> <span class="token number">5542</span>
<span class="token number">192.168</span>.1.200 - - <span class="token punctuation">[</span>01/Mar/2023:14:32:07 +0800<span class="token punctuation">]</span> <span class="token string">"GET /bg-nav.png HTTP/1.1"</span> <span class="token number">200</span> <span class="token number">1401</span></code></pre></div></figure>



<h3 id="1-2-3-Tomcat组件"><a href="#1-2-3-Tomcat组件" class="headerlink" title="1.2.3 Tomcat组件"></a>1.2.3 Tomcat组件</h3><p><img src="/2023/03/01/Web/Tomcat/tomcat02/image-20230301193155195.png" srcset="/img/loading.gif" lazyload alt="image-20230301193155195"> </p>
<ul>
<li>顶级组件：Server，代表整个Tomcat容器，一台主机可以启动多个tomcat实例，确保端口不冲突。</li>
<li>服务类组件：Service，实现组织Engine和Connector，建立两者之间的联系，Service里面只能包含一个Engine</li>
<li>连接器组件：Connector，有HTTP（默认端口8080&#x2F;tcp）、HTTPS（默认端口8443&#x2F;tcp）  、AJP（默认端口8009&#x2F;tcp）协议的连接器，AJP（Apache Jserv protocol）是一种基于TCP的二进制通讯协议。  </li>
<li>容器类：Engine、Host（虚拟主机）、Context(上下文件,解决路径映射)都是容器类组件，可以嵌入其它组件，内部配置如何运行应用程序。  <ul>
<li>Engine：引擎，用来响应并处理用户请求。一个Engine上可以绑定多个Connector</li>
<li>Host：虚拟主机，可以实现多虚拟主机，例如使用不同的主机头区分。</li>
<li>Context：应用的上下文，配置特定url路径映射和目录的映射关系：url &#x3D;&gt; directory</li>
</ul>
</li>
<li>内嵌类： 可以内嵌到其他组件内，valve、logger、realm、loader、manager等。以logger举例，在不同容器组件内分别定义。</li>
<li>集群类组件：listener、cluster。</li>
</ul>
<p><strong>Tomcat核心组件：</strong></p>
<ol>
<li>Tomcat启动一个Server进程。可以启动多个Server，即Tomcat多实例。</li>
<li>创建一个Service提供服务。可以创建多个Service。每个Service中，是Engine和其连接器Connector的关联配置。</li>
<li>可以为这个Service提供多个连接器Connector，这些Connector使用了不同的协议，绑定了不同的端口。其作用就是处理来自客户端的不同的连接请求或响应。</li>
<li>Service内部还定义了Engine，引擎才是真正的处理请求的入口，其内部定义多个虚拟主机Host。Engine对请求头做了分析，将请求发送给相应的虚拟主机，如果没有匹配，数据就发往Engine上的defaultHost缺省虚拟主机，Engine上的缺省虚拟主机可以修改。</li>
<li>Host 定义虚拟主机，虚拟主机有name名称，通过名称匹配。</li>
<li>Context 定义应用程序单独的路径映射和配置。</li>
</ol>
<figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim /usr/local/tomcat/conf/server.xml</span>
<span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.0"</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">"UTF-8"</span>?<span class="token operator">></span>
<span class="token operator">&lt;</span>Server <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token string">"8005"</span> <span class="token assign-left variable">shutdown</span><span class="token operator">=</span><span class="token string">"SHUTDOWN"</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>Service <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"Catalina"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>Connector <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token string">"8080"</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span><span class="token string">"HTTP/1.1"</span>
               <span class="token assign-left variable">connectionTimeout</span><span class="token operator">=</span><span class="token string">"20000"</span>
               <span class="token assign-left variable">redirectPort</span><span class="token operator">=</span><span class="token string">"8443"</span> /<span class="token operator">></span>
    <span class="token operator">&lt;</span>Connector <span class="token assign-left variable">executor</span><span class="token operator">=</span><span class="token string">"tomcatThreadPool"</span>
               <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token string">"8080"</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span><span class="token string">"HTTP/1.1"</span>
               <span class="token assign-left variable">connectionTimeout</span><span class="token operator">=</span><span class="token string">"20000"</span>
               <span class="token assign-left variable">redirectPort</span><span class="token operator">=</span><span class="token string">"8443"</span> /<span class="token operator">></span>
    <span class="token operator">&lt;</span>Connector <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token string">"8443"</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span><span class="token string">"org.apache.coyote.http11.Http11NioProtocol"</span>
               <span class="token assign-left variable">maxThreads</span><span class="token operator">=</span><span class="token string">"150"</span> <span class="token assign-left variable">SSLEnabled</span><span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>/Connector<span class="token operator">></span>
    <span class="token operator">&lt;</span>Connector <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token string">"8443"</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span><span class="token string">"org.apache.coyote.http11.Http11AprProtocol"</span>
               <span class="token assign-left variable">maxThreads</span><span class="token operator">=</span><span class="token string">"150"</span> <span class="token assign-left variable">SSLEnabled</span><span class="token operator">=</span><span class="token string">"true"</span> <span class="token operator">></span> 
    <span class="token operator">&lt;</span>/Connector<span class="token operator">></span>

    <span class="token operator">&lt;</span>Connector <span class="token assign-left variable">protocol</span><span class="token operator">=</span><span class="token string">"AJP/1.3"</span>
               <span class="token assign-left variable">address</span><span class="token operator">=</span><span class="token string">"::1"</span>
               <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token string">"8009"</span>
               <span class="token assign-left variable">redirectPort</span><span class="token operator">=</span><span class="token string">"8443"</span> /<span class="token operator">></span>

    <span class="token operator">&lt;</span>Engine <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"Catalina"</span> <span class="token assign-left variable">defaultHost</span><span class="token operator">=</span><span class="token string">"localhost"</span> <span class="token assign-left variable">jvmRoute</span><span class="token operator">=</span><span class="token string">"jvm1"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>Engine <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"Catalina"</span> <span class="token assign-left variable">defaultHost</span><span class="token operator">=</span><span class="token string">"localhost"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>Host <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"localhost"</span>  <span class="token assign-left variable">appBase</span><span class="token operator">=</span><span class="token string">"webapps"</span>
            <span class="token assign-left variable">unpackWARs</span><span class="token operator">=</span><span class="token string">"true"</span> <span class="token assign-left variable">autoDeploy</span><span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>/Host<span class="token operator">></span>
    <span class="token operator">&lt;</span>/Engine<span class="token operator">></span>
  <span class="token operator">&lt;</span>/Service<span class="token operator">></span>
<span class="token operator">&lt;</span>/Server<span class="token operator">></span></code></pre></div></figure>



<p><strong>Tomcat处理请求过程：</strong></p>
<p>请求地址：<a target="_blank" rel="noopener" href="http://localhost:8080/test/index.jsp">http://localhost:8080/test/index.jsp</a> 过程：</p>
<ol>
<li>浏览器端的请求被发送到服务器的端口为8080，Tomcat进程监听在此端口上。通过侦听的HTTP&#x2F;1.1 Connector获得此请求。</li>
<li>Connector把该请求交给它所在的Service的Engine来处理，并等待Engine的响应。</li>
<li>Engine获得请求localhost:8080&#x2F;test&#x2F;index.jsp，遍历它所有虚拟主机Host。</li>
<li>Engine匹配到名为localhost的Host。如果匹配不到,就把请求交给该Engine中的defaultHost处理。</li>
<li>localhost Host获得请求&#x2F;test&#x2F;index.jsp，匹配它所拥有的所有Context。</li>
<li>Host匹配到路径为&#x2F;test的Context。</li>
<li>path&#x3D;&#x2F;test的Context获得请求index.jsp，在它的mapping table中寻找对应的servlet。</li>
<li>Context匹配到URL PATTERN为 *.jsp 的servlet，对应于JspServlet类构造HttpServletRequest对象和HttpServletResponse对象，作为参数调用JspServlet的doGet或doPost方法。</li>
<li>Context把执行完了之后的HttpServletResponse对象返回给Host。</li>
<li>Host把HttpServletResponse对象返回给Engine。</li>
<li>Engine把HttpServletResponse对象返回给Connector。</li>
<li>Connector把HttpServletResponse对象返回给浏览器端。</li>
</ol>
<h3 id="1-2-4-Tomcat常见配置"><a href="#1-2-4-Tomcat常见配置" class="headerlink" title="1.2.4 Tomcat常见配置"></a>1.2.4 Tomcat常见配置</h3><ul>
<li>8005端口安全配置</li>
</ul>
<figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#8005是Tomcat的管理端口，默认监听在127.0.0.1上。无需验证就可发送SHUTDOWN (大小写敏感)这个字符串，tomcat接收到后就会关闭此Server。</span>
<span class="token comment">#此管理功能建议禁用，可将SHUTDOWN改为一串猜不出的字符串实现。或者port修改成 0, 会使用随机端口,如:40357。</span>
<span class="token comment">#port设为-1等无效端口,将关闭此功能。</span>
<span class="token comment">#此行不能被注释,否则无法启动tomcat服务</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim /usr/local/tomcat/conf/server.xml</span>
<span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.0"</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">"UTF-8"</span>?<span class="token operator">></span>
<span class="token operator">&lt;</span>Server <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token string">"8005"</span> <span class="token assign-left variable">shutdown</span><span class="token operator">=</span><span class="token string">"SHUTDOWN"</span><span class="token operator">></span>
  <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
  <span class="token operator">&lt;</span>/Service<span class="token operator">></span>
<span class="token operator">&lt;</span>/Server<span class="token operator">></span></code></pre></div></figure>



<ul>
<li>显示指定的http服务器版本信息</li>
</ul>
<figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#默认不显示tomcat的http的Server头信息, 可以指定tomcat的http的Server头信息为相应的值。</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim /usr/local/tomcat/conf/server.xml</span>
<span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.0"</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">"UTF-8"</span>?<span class="token operator">></span>
<span class="token operator">&lt;</span>Server <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token string">"8005"</span> <span class="token assign-left variable">shutdown</span><span class="token operator">=</span><span class="token string">"SHUTDOWN"</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>Service <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"Catalina"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>Connector <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token string">"8080"</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span><span class="token string">"HTTP/1.1"</span>
               <span class="token assign-left variable">connectionTimeout</span><span class="token operator">=</span><span class="token string">"20000"</span>
               <span class="token assign-left variable">redirectPort</span><span class="token operator">=</span><span class="token string">"8443"</span> /<span class="token operator">></span>
   <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
    <span class="token operator">&lt;</span>/Engine<span class="token operator">></span>
  <span class="token operator">&lt;</span>/Service<span class="token operator">></span>
<span class="token operator">&lt;</span>/Server<span class="token operator">></span>

<span class="token comment">#修改配置,指定想显示的tomcat版本,添加Server="chsblogs"</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim /usr/local/tomcat/conf/server.xml</span>
<span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.0"</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">"UTF-8"</span>?<span class="token operator">></span>
<span class="token operator">&lt;</span>Server <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token string">"8005"</span> <span class="token assign-left variable">shutdown</span><span class="token operator">=</span><span class="token string">"SHUTDOWN"</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>Service <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"Catalina"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>Connector <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token string">"8080"</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span><span class="token string">"HTTP/1.1"</span>
               <span class="token assign-left variable">connectionTimeout</span><span class="token operator">=</span><span class="token string">"20000"</span>
               <span class="token assign-left variable">redirectPort</span><span class="token operator">=</span><span class="token string">"8443"</span> <span class="token assign-left variable">Server</span><span class="token operator">=</span><span class="token string">"chsblogs"</span>/<span class="token operator">></span>
   <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
    <span class="token operator">&lt;</span>/Engine<span class="token operator">></span>
  <span class="token operator">&lt;</span>/Service<span class="token operator">></span>
<span class="token operator">&lt;</span>/Server<span class="token operator">></span>

<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># systemctl restart tomcat</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># curl -I 192.168.1.10:8080</span>
HTTP/1.1 <span class="token number">200</span> 
Content-Type: text/html<span class="token punctuation">;</span><span class="token assign-left variable">charset</span><span class="token operator">=</span>UTF-8
Transfer-Encoding: chunked
Date: Wed, 01 Mar <span class="token number">2023</span> <span class="token number">12</span>:02:46 GMT
Server: chsblogs</code></pre></div></figure>



<ul>
<li>多虚拟主机配置</li>
</ul>
<figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#多虚拟主机配置说明:</span>
<span class="token comment">#name:必须是主机名，用主机名来匹配。</span>
<span class="token comment">#appBase:当前主机的网页根目录，是相对于 $CATALINA_HOME ，也可以使用绝对路径。</span>
<span class="token comment">#unpackWARs:是否自动解压war格式。</span>
<span class="token comment">#autoDeploy:热部署，自动加载并运行应用。</span>

<span class="token comment">#再添加和配置一个新的虚拟主机，并将myapp部署到/data/chsblogs目录下</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim /usr/local/tomcat/conf/server.xml</span>
<span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.0"</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">"UTF-8"</span>?<span class="token operator">></span>
      <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
      <span class="token operator">&lt;</span>Host <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"localhost"</span>  <span class="token assign-left variable">appBase</span><span class="token operator">=</span><span class="token string">"webapps"</span>
            <span class="token assign-left variable">unpackWARs</span><span class="token operator">=</span><span class="token string">"true"</span> <span class="token assign-left variable">autoDeploy</span><span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>/Host<span class="token operator">></span>
      <span class="token operator">&lt;</span>Host <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"web1.chsblogs.com"</span> <span class="token assign-left variable">appBase</span><span class="token operator">=</span><span class="token string">"/data/chsblogs/"</span> <span class="token assign-left variable">unpackWARs</span><span class="token operator">=</span><span class="token string">"True"</span>
      <span class="token assign-left variable">autoDeploy</span><span class="token operator">=</span><span class="token string">"false"</span><span class="token operator">></span>

        <span class="token operator">&lt;</span>Valve <span class="token assign-left variable">className</span><span class="token operator">=</span><span class="token string">"org.apache.catalina.valves.AccessLogValve"</span> <span class="token assign-left variable">directory</span><span class="token operator">=</span><span class="token string">"logs"</span>
            <span class="token assign-left variable">prefix</span><span class="token operator">=</span><span class="token string">"web1_access_log"</span> <span class="token assign-left variable">suffix</span><span class="token operator">=</span><span class="token string">".txt"</span> <span class="token assign-left variable">pattern</span><span class="token operator">=</span><span class="token string">"%h %l %u %t &amp;quot;%r&amp;quot; %s%b"</span> /<span class="token operator">></span>
      <span class="token operator">&lt;</span>/Host<span class="token operator">></span>
    <span class="token operator">&lt;</span>/Engine<span class="token operator">></span>
  <span class="token operator">&lt;</span>/Service<span class="token operator">></span>
<span class="token operator">&lt;</span>/Server<span class="token operator">></span>

<span class="token comment">#准备虚拟主机的数据目录</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># mkdir /data/chsblogs/ROOT -pv</span>
mkdir: created directory ‘/data’
mkdir: created directory ‘/data/chsblogs’
mkdir: created directory ‘/data/chsblogs/ROOT’
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># chown -R tomcat.tomcat /data/chsblogs/</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># echo "web1.chsblogs.com" > /data/chsblogs/ROOT/index.html</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># systemctl restart tomcat</span>

<span class="token comment">#测试</span>
http://web1.chsblogs.com:8080/</code></pre></div></figure>



<ul>
<li>修改tomcat端口为80</li>
</ul>
<figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#注意: 因为以tomcat用户运行,不能直接使用1024以下的端口,需要修改tomcat的运行身份,否则会出现下面错误。</span>
<span class="token comment">#/usr/local/tomcat/logs/catalina.out文件：Caused by: java.net.SocketException: Permission denied</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim /usr/local/tomcat/conf/server.xml</span>
<span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.0"</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">"UTF-8"</span>?<span class="token operator">></span>
<span class="token operator">&lt;</span>Server <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token string">"8005"</span> <span class="token assign-left variable">shutdown</span><span class="token operator">=</span><span class="token string">"SHUTDOWN"</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>Service <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"Catalina"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>Connector <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token string">"8080"</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span><span class="token string">"HTTP/1.1"</span>
               <span class="token assign-left variable">connectionTimeout</span><span class="token operator">=</span><span class="token string">"20000"</span>
               <span class="token assign-left variable">redirectPort</span><span class="token operator">=</span><span class="token string">"8443"</span> /<span class="token operator">></span>     
    <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
    <span class="token operator">&lt;</span>Engine <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"Catalina"</span> <span class="token assign-left variable">defaultHost</span><span class="token operator">=</span><span class="token string">"localhost"</span> <span class="token assign-left variable">jvmRoute</span><span class="token operator">=</span><span class="token string">"jvm1"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>Engine <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"Catalina"</span> <span class="token assign-left variable">defaultHost</span><span class="token operator">=</span><span class="token string">"localhost"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>Host <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"localhost"</span>  <span class="token assign-left variable">appBase</span><span class="token operator">=</span><span class="token string">"webapps"</span>
            <span class="token assign-left variable">unpackWARs</span><span class="token operator">=</span><span class="token string">"true"</span> <span class="token assign-left variable">autoDeploy</span><span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>/Host<span class="token operator">></span>
    <span class="token operator">&lt;</span>/Engine<span class="token operator">></span>
  <span class="token operator">&lt;</span>/Service<span class="token operator">></span>
<span class="token operator">&lt;</span>/Server<span class="token operator">></span>

<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim /lib/systemd/system/tomcat.service</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>.
<span class="token comment">#User=tomcat</span>
<span class="token comment">#Group=tomcat</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># systemctl daemon-reload</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># systemctl restart tomcat</span></code></pre></div></figure>



<ul>
<li>Context配置</li>
</ul>
<figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#Context作用:路径映射：将url映射至指定路径，而非使用appBase下的物理目录，实现虚拟目录功能。应用独立配置，例如单独配置应用日志、单独配置应用访问控制。</span>

<span class="token comment">#path：指的是访问的URL路径，如果path与appBase下面的子目录同名，context的docBase路径优先更高。</span>
<span class="token comment">#docBase：可以是磁盘文件的绝对路径，也可以是相对路径（相对于Host的appBase）。</span>
<span class="token comment">#reloadable：true表示如果WEB-INF/classes或META-INF/lib目录下.class文件有改动，就会将WEB应用重新加载。生产环境中，建议使用false来禁用。</span>
<span class="token comment">#映射指定路径</span>
  <span class="token operator">&lt;</span>Context <span class="token assign-left variable">path</span><span class="token operator">=</span><span class="token string">"/test"</span> <span class="token assign-left variable">docBase</span><span class="token operator">=</span><span class="token string">"/data/test"</span> <span class="token assign-left variable">reloadable</span><span class="token operator">=</span><span class="token string">"true"</span> /<span class="token operator">></span>
<span class="token comment">#映射站点的根目录</span>
  <span class="token operator">&lt;</span>Context <span class="token assign-left variable">path</span><span class="token operator">=</span><span class="token string">"/"</span> <span class="token assign-left variable">docBase</span><span class="token operator">=</span><span class="token string">"/data/website"</span> <span class="token assign-left variable">reloadable</span><span class="token operator">=</span><span class="token string">"true"</span> /<span class="token operator">></span>
<span class="token comment">#还可以添加日志等独立的配置</span>
  <span class="token operator">&lt;</span>Context <span class="token assign-left variable">path</span><span class="token operator">=</span><span class="token string">"/test"</span> <span class="token assign-left variable">docBase</span><span class="token operator">=</span><span class="token string">"/data/test"</span> <span class="token assign-left variable">reloadable</span><span class="token operator">=</span><span class="token string">"true"</span> <span class="token operator">></span>
    <span class="token operator">&lt;</span>Valve <span class="token assign-left variable">className</span><span class="token operator">=</span><span class="token string">"org.apache.catalina.valves.AccessLogValve"</span> <span class="token assign-left variable">directory</span><span class="token operator">=</span><span class="token string">"logs"</span>
    <span class="token assign-left variable">prefix</span><span class="token operator">=</span><span class="token string">"localhost_test_log"</span> <span class="token assign-left variable">suffix</span><span class="token operator">=</span><span class="token string">".txt"</span>
    <span class="token assign-left variable">pattern</span><span class="token operator">=</span><span class="token string">"%h %l %u %t &amp;quot;%r&amp;quot; %s %b"</span> /<span class="token operator">></span>
  <span class="token operator">&lt;</span>/Context<span class="token operator">></span>
  
<span class="token comment">#Valve组件:可以定义日志</span>
<span class="token comment">#定义访问日志：org.apache.catalina.valves.AccessLogValve</span>
<span class="token comment">#定义访问控制：org.apache.catalina.valves.RemoteAddrValve</span>
<span class="token comment">#例如：</span>
<span class="token operator">&lt;</span>Valve <span class="token assign-left variable">className</span><span class="token operator">=</span><span class="token string">"org.apache.catalina.valves.RemoteAddrValve"</span>
<span class="token assign-left variable">deny</span><span class="token operator">=</span><span class="token string">"10\.0\.0\.\d+"</span>/<span class="token operator">></span>

<span class="token operator">&lt;</span>Valve <span class="token assign-left variable">className</span><span class="token operator">=</span><span class="token string">"org.apache.catalina.valves.AccessLogValve"</span> <span class="token assign-left variable">directory</span><span class="token operator">=</span><span class="token string">"logs"</span>
  <span class="token assign-left variable">prefix</span><span class="token operator">=</span><span class="token string">"localhost_access_log"</span> <span class="token assign-left variable">suffix</span><span class="token operator">=</span><span class="token string">".txt"</span>
  <span class="token assign-left variable">pattern</span><span class="token operator">=</span><span class="token string">"%h %l %u %t &amp;quot;%r&amp;quot; %s %b"</span> /<span class="token operator">></span></code></pre></div></figure>

<figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#1.虚拟主机上利用context实现虚拟目录：准备虚拟主机的数据目录</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># mkdir /data/myapp-v1</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim /data/myapp-v1/index.jsp</span>
myapp-v1
<span class="token comment">#使用了软链接，原因方便后期版升级或回滚，如是是版本升级，需要将软链接指向myapp-v2，重新启动。如果新版上线后，出现问题，重新修改软链接到上一个版本的目录，并重启，就可以实现回滚。</span>
<span class="token punctuation">[</span>root@node10 data<span class="token punctuation">]</span><span class="token comment"># ln -sv myapp-v1 myapp</span>
‘myapp’ -<span class="token operator">></span> ‘myapp-v1’

<span class="token comment">#2.配置server.xml</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim /usr/local/tomcat/conf/server.xml</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token operator">&lt;</span>Host <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"myapp.chsblogs.com"</span> <span class="token assign-left variable">appBase</span><span class="token operator">=</span><span class="token string">"/data/chsblogs/"</span> <span class="token assign-left variable">unpackWARs</span><span class="token operator">=</span><span class="token string">"True"</span>
      <span class="token assign-left variable">autoDeploy</span><span class="token operator">=</span><span class="token string">"false"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>Context <span class="token assign-left variable">path</span><span class="token operator">=</span><span class="token string">"/myapp"</span> <span class="token assign-left variable">docBase</span><span class="token operator">=</span><span class="token string">"/data/myapp"</span> <span class="token assign-left variable">reloadable</span><span class="token operator">=</span><span class="token string">"true"</span> /<span class="token operator">></span>

        <span class="token operator">&lt;</span>Valve <span class="token assign-left variable">className</span><span class="token operator">=</span><span class="token string">"org.apache.catalina.valves.AccessLogValve"</span> <span class="token assign-left variable">directory</span><span class="token operator">=</span><span class="token string">"logs"</span>
            <span class="token assign-left variable">prefix</span><span class="token operator">=</span><span class="token string">"web1_access_log"</span> <span class="token assign-left variable">suffix</span><span class="token operator">=</span><span class="token string">".txt"</span> <span class="token assign-left variable">pattern</span><span class="token operator">=</span><span class="token string">"%h %l %u %t &amp;quot;%r&amp;quot; %s%b"</span> /<span class="token operator">></span>
      <span class="token operator">&lt;</span>/Host<span class="token operator">></span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token comment">#3.访问测试</span>
http://myapp.chsblogs.com:8080/myapp/

<span class="token comment">#4.myapp版本升级</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># mkdir /data/myapp-v2</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># echo "myapp-v2" > /data/myapp-v2/index.jsp</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># cd /data/</span>
<span class="token punctuation">[</span>root@node10 data<span class="token punctuation">]</span><span class="token comment"># rm -rf myapp #删除软链接，仍然可以访问旧版本</span>
<span class="token punctuation">[</span>root@node10 data<span class="token punctuation">]</span><span class="token comment"># ln -s myapp-v2 myapp</span>
<span class="token punctuation">[</span>root@node10 data<span class="token punctuation">]</span><span class="token comment"># ls</span>
chsblogs  myapp  myapp-v1  myapp-v2
<span class="token punctuation">[</span>root@node10 data<span class="token punctuation">]</span><span class="token comment"># systemctl restart tomcat</span>

<span class="token comment">#5.访问测试</span>
http://myapp.chsblogs.com:8080/myapp/

<span class="token comment">#6.myapp版本回退</span>
<span class="token punctuation">[</span>root@node10 data<span class="token punctuation">]</span><span class="token comment"># rm -rf myapp</span>
<span class="token punctuation">[</span>root@node10 data<span class="token punctuation">]</span><span class="token comment"># ln -s myapp-v1 myapp</span>
<span class="token punctuation">[</span>root@node10 data<span class="token punctuation">]</span><span class="token comment"># systemctl restart tomcat</span></code></pre></div></figure>



<ul>
<li><p>基于Web方式的Host Manager虚拟主机管理</p>
</li>
<li><p>基于Web的管理Server status和Manager App实现应用部署  </p>
</li>
<li><p>其它配置</p>
</li>
</ul>
<figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#1.Service配置：一般情况下，一个Server实例配置一个Service，name属性相当于该Service的ID</span>
<span class="token operator">&lt;</span>Service <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"Catalina"</span><span class="token operator">></span>

<span class="token comment">#2.连接器配置：redirectPort，如果访问HTTPS协议，自动转向这个连接器。但大多数时候，Tomcat并不会开启HTTPS，因为Tomcat往往部署在内部，HTTPS性能较差</span>
<span class="token operator">&lt;</span>Connector <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token string">"8080"</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span><span class="token string">"HTTP/1.1"</span>
  <span class="token assign-left variable">connectionTimeout</span><span class="token operator">=</span><span class="token string">"20000"</span>
  <span class="token assign-left variable">redirectPort</span><span class="token operator">=</span><span class="token string">"8443"</span> /<span class="token operator">></span>

<span class="token comment">#3.引擎配置</span>
<span class="token operator">&lt;</span>Engine <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"Catalina"</span> <span class="token assign-left variable">defaultHost</span><span class="token operator">=</span><span class="token string">"localhost"</span><span class="token operator">></span>

<span class="token comment">#4.defaultHost配置：defaultHost指向内部定义某虚拟主机。缺省虚拟主机可以改动，默认localhost</span>
<span class="token operator">&lt;</span>Host <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"localhost"</span> <span class="token assign-left variable">appBase</span><span class="token operator">=</span><span class="token string">"webapps"</span> <span class="token assign-left variable">unpackWARs</span><span class="token operator">=</span><span class="token string">"true"</span> <span class="token assign-left variable">autoDeploy</span><span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">></span></code></pre></div></figure>



<h2 id="1-3-基于Tomcat应用部署"><a href="#1-3-基于Tomcat应用部署" class="headerlink" title="1.3 基于Tomcat应用部署"></a>1.3 基于Tomcat应用部署</h2><h3 id="1-3-1-应用归档格式"><a href="#1-3-1-应用归档格式" class="headerlink" title="1.3.1 应用归档格式"></a>1.3.1 应用归档格式</h3><ul>
<li>.war：Webapp打包，类似zip格式文件。通常包括一个应用的所有资源，比如jsp，html，配置文件等。</li>
<li>.jar：EJB类文件的打包压缩类zip格式文件，,包括很多的class文件。</li>
</ul>
<figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#传统应用开发测试后，通常打包为war格式，这种文件部署到Tomcat的webapps目录下，并默认会自动解包展开和部署上线。</span>
 <span class="token operator">&lt;</span>Host <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"localhost"</span>  <span class="token assign-left variable">appBase</span><span class="token operator">=</span><span class="token string">"webapps"</span>
            <span class="token assign-left variable">unpackWARs</span><span class="token operator">=</span><span class="token string">"true"</span> <span class="token assign-left variable">autoDeploy</span><span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">></span></code></pre></div></figure>



<h3 id="1-3-2-部署方式"><a href="#1-3-2-部署方式" class="headerlink" title="1.3.2 部署方式"></a>1.3.2 部署方式</h3><ul>
<li><p>部署：将webapp的源文件放置到目标目录，通过web.xml和context.xml文件中配置的路径就可以访问该webapp，通过类加载器加载其特有的类和依赖的类到JVM上，即：最终用户可以通过浏览器访问该应用。</p>
<ul>
<li>自动部署：Tomcat一旦发现多了一个web应用APP.war包，默认会自动把它解压缩，加载并启动起来。</li>
<li>手动部署：<ul>
<li>冷部署：将webapp放到指定目录，才去启动Tomcat服务  </li>
<li>热部署：Tomcat服务不停止，需要依赖manager、ant脚本、tcd（tomcat client  deployer）等工具。</li>
</ul>
</li>
</ul>
</li>
<li><p>反部署：停止webapp运行，并从JVM上清除已经加载的类，从Tomcat应用目录中移除部署的文件。</p>
</li>
<li><p>启动：webapp能够访问  </p>
</li>
<li><p>停止：webapp不能访问，不能提供服务，但是JVM并不清除它。</p>
</li>
</ul>
<h3 id="1-3-3-部署Webapp目录结构"><a href="#1-3-3-部署Webapp目录结构" class="headerlink" title="1.3.3 部署Webapp目录结构"></a>1.3.3 部署Webapp目录结构</h3><figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#目录结构一般由开发用工具自动生成，以下模拟生成相关目录</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># mkdir projects/myapp/&#123;WEB-INF,META-INF,classes,lib&#125; -pv</span>
mkdir: created directory ‘projects’
mkdir: created directory ‘projects/myapp’
mkdir: created directory ‘projects/myapp/WEB-INF’
mkdir: created directory ‘projects/myapp/META-INF’
mkdir: created directory ‘projects/myapp/classes’
mkdir: created directory ‘projects/myapp/lib’

<span class="token comment">#创建应用首页</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim projects/myapp/index.jsp</span>
<span class="token operator">&lt;</span>html<span class="token operator">></span>
  <span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>title<span class="token operator">></span>Hello World<span class="token operator">!</span><span class="token operator">&lt;</span>/title<span class="token operator">></span>
  <span class="token operator">&lt;</span>/head<span class="token operator">></span>
  <span class="token operator">&lt;</span>body<span class="token operator">></span>
    <span class="token operator">&lt;</span>%
      out.println<span class="token punctuation">(</span><span class="token string">"Hello World!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    %<span class="token operator">></span>
  <span class="token operator">&lt;</span>/body<span class="token operator">></span>
<span class="token operator">&lt;</span>/html<span class="token operator">></span>

<span class="token comment">#手动复制项目目录到webapps目录下去</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># cp -r projects/myapp/ /usr/local/tomcat/webapps/</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># chown -R tomcat.tomcat /usr/local/tomcat/webapps/myapp/</span>

<span class="token comment">#访问测试s</span>
http://192.168.1.10:8080/myapp/</code></pre></div></figure>



<h3 id="1-3-4-自动部署war包"><a href="#1-3-4-自动部署war包" class="headerlink" title="1.3.4 自动部署war包"></a>1.3.4 自动部署war包</h3><figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#制作应用的war包文件</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># mkdir app1</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># touch app1/test.html</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># touch app1/test.jsp</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim app1/test.jsp </span>
<span class="token operator">&lt;</span>html<span class="token operator">></span>
  <span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>title<span class="token operator">></span>Hello World<span class="token operator">!</span><span class="token operator">&lt;</span>/title<span class="token operator">></span>
  <span class="token operator">&lt;</span>/head<span class="token operator">></span>
  <span class="token operator">&lt;</span>body<span class="token operator">></span>
    <span class="token operator">&lt;</span>%
      out.println<span class="token punctuation">(</span><span class="token string">"Hello World!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    %<span class="token operator">></span>
  <span class="token operator">&lt;</span>/body<span class="token operator">></span>
<span class="token operator">&lt;</span>/html<span class="token operator">></span>

<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># vim app1/test.html</span>
<span class="token operator">&lt;</span>html<span class="token operator">></span>
  <span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>title<span class="token operator">></span>Hello World<span class="token operator">!</span><span class="token operator">&lt;</span>/title<span class="token operator">></span>
  <span class="token operator">&lt;</span>/head<span class="token operator">></span>
  <span class="token operator">&lt;</span>body<span class="token operator">></span>
    <span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">1</span>></span>Hello World<span class="token operator">!</span><span class="token operator">&lt;</span>/h<span class="token operator"><span class="token file-descriptor important">1</span>></span>
  <span class="token operator">&lt;</span>/body<span class="token operator">></span>
<span class="token operator">&lt;</span>/html<span class="token operator">></span>

<span class="token comment">#生成war包文件app1.war,此文件的名称决定了tomcat子目录的名称</span>
<span class="token punctuation">[</span>root@node10 app1<span class="token punctuation">]</span><span class="token comment"># jar cvf app1.war *</span>
added manifest
adding: test.html<span class="token punctuation">(</span>in <span class="token operator">=</span> <span class="token number">111</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>out<span class="token operator">=</span> <span class="token number">67</span><span class="token punctuation">)</span><span class="token punctuation">(</span>deflated <span class="token number">39</span>%<span class="token punctuation">)</span>
adding: test.jsp<span class="token punctuation">(</span>in <span class="token operator">=</span> <span class="token number">132</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>out<span class="token operator">=</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">(</span>deflated <span class="token number">32</span>%<span class="token punctuation">)</span>
<span class="token punctuation">[</span>root@node10 app1<span class="token punctuation">]</span><span class="token comment"># ls</span>
app1.war  test.html  test.jsp
<span class="token punctuation">[</span>root@node10 app1<span class="token punctuation">]</span><span class="token comment"># chown tomcat.tomcat app1.war</span>

<span class="token comment">#自动应用部署上面的war包</span>
<span class="token punctuation">[</span>root@node10 app1<span class="token punctuation">]</span><span class="token comment"># cp -p app1.war /usr/local/tomcat/webapps/</span>
<span class="token comment">#tomcat将app1.war自动解压缩</span>
<span class="token punctuation">[</span>root@node10 webapps<span class="token punctuation">]</span><span class="token comment"># ls</span>
app1  app1.war  docs  examples  host-manager  manager  myapp  ROOT

<span class="token comment">#访问测试，访问jsp文件后，tomcat会自动将jsp转换和编译生成work目录下对应的java和class文件</span>
http://192.168.1.10:8080/app1/test.jsp

<span class="token comment">#自动删除（反部署），过几秒再查看，发现app1目录也随之删除</span>
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># cd /usr/local/tomcat/webapps/</span>
<span class="token punctuation">[</span>root@node10 webapps<span class="token punctuation">]</span><span class="token comment"># ls</span>
app1  app1.war  docs  examples  host-manager  manager  myapp  ROOT
<span class="token punctuation">[</span>root@node10 webapps<span class="token punctuation">]</span><span class="token comment"># rm -rf app1.war</span>
<span class="token punctuation">[</span>root@node10 webapps<span class="token punctuation">]</span><span class="token comment"># ls</span>
docs  examples  host-manager  manager  myapp  ROOT</code></pre></div></figure>



<h3 id="1-3-5-部署基于JAVA的博客系统-JPress"><a href="#1-3-5-部署基于JAVA的博客系统-JPress" class="headerlink" title="1.3.5 部署基于JAVA的博客系统 JPress"></a>1.3.5 部署基于JAVA的博客系统 JPress</h3><figure><div class="code-wrapper"><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># ll jpress-v5.0.8.war </span>
-rw-r--r--. <span class="token number">1</span> root root <span class="token number">127888242</span> Mar  <span class="token number">1</span> <span class="token number">17</span>:04 jpress-v5.0.8.war
<span class="token punctuation">[</span>root@node10 ~<span class="token punctuation">]</span><span class="token comment"># cp jpress-v5.0.8.war /usr/local/tomcat/webapps/</span>

<span class="token comment">#自动解压缩生成jpress-v5.0.8目录</span>
<span class="token punctuation">[</span>root@node10 webapps<span class="token punctuation">]</span><span class="token comment"># ls</span>
docs  examples  host-manager  jpress-v5.0.8  jpress-v5.0.8.war  manager  myapp  ROOT

<span class="token comment">#生成软链接</span>
<span class="token punctuation">[</span>root@node10 webapps<span class="token punctuation">]</span><span class="token comment"># ln -s jpress-v5.0.8 jpress</span>

<span class="token comment">#访问链接配置</span>
http://192.168.1.10:8080/jpress</code></pre></div></figure>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Linux/" class="category-chain-item">Linux</a>
  
  
    <span>></span>
    
  <a href="/categories/Linux/Tomcat/" class="category-chain-item">Tomcat</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Tomcat/">#Tomcat</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>(2).Tomcat安装及配置</div>
      <div>http://chsblogs.com/2023/03/01/Web/Tomcat/tomcat02/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>陈怀森</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年3月1日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/03/02/Web/Tomcat/tomcat03/" title="(3).Tomcat集群部署">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">(3).Tomcat集群部署</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/02/28/Web/Tomcat/tomcat01/" title="(1).Tomcat之JDK安装">
                        <span class="hidden-mobile">(1).Tomcat之JDK安装</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    
      <script type="text/javascript">
        var disqus_config = function() {
          this.page.url = 'http://chsblogs.com/2023/03/01/Web/Tomcat/tomcat02/';
          this.page.identifier = '/2023/03/01/Web/Tomcat/tomcat02/';
        };
        Fluid.utils.loadComments('#disqus_thread', function() {
          var d = document, s = d.createElement('script');
          s.src = '//' + 'fluid' + '.disqus.com/embed.js';
          s.setAttribute('data-timestamp', new Date());
          (d.head || d.body).appendChild(s);
        });
      </script>
    
    <noscript>Please enable JavaScript to view the comments</noscript>
  </div>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-left: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="Tomcat"
        id="heading-8f72e28063c30c7468fb6af4653f4f9c" role="tab" data-toggle="collapse" href="#collapse-8f72e28063c30c7468fb6af4653f4f9c"
        aria-expanded="true"
      >
        Tomcat
        <span class="list-group-count">(4)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-8f72e28063c30c7468fb6af4653f4f9c"
           role="tabpanel" aria-labelledby="heading-8f72e28063c30c7468fb6af4653f4f9c">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2023/02/28/Web/Tomcat/tomcat01/" title="(1).Tomcat之JDK安装"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">(1).Tomcat之JDK安装</span>
        </a>
      
    
      
      
        <a href="/2023/03/01/Web/Tomcat/tomcat02/" title="(2).Tomcat安装及配置"
           class="list-group-item list-group-item-action
           active">
          <span class="category-post">(2).Tomcat安装及配置</span>
        </a>
      
    
      
      
        <a href="/2023/03/02/Web/Tomcat/tomcat03/" title="(3).Tomcat集群部署"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">(3).Tomcat集群部署</span>
        </a>
      
    
      
      
        <a href="/2023/03/02/Web/Tomcat/tomcat04/" title="(4).Tomcat性能优化"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">(4).Tomcat性能优化</span>
        </a>
      
    
  </div>

        
      </div>
    </div>
  
</div>


  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
  
  
    <!-- 备案信息 ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      Copyright © 2023 by 陈怀森
    </a>
  </span>
  
    
      <span>
        <a
          href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=20005950"
          rel="nofollow noopener"
          class="beian-police"
          target="_blank"
        >
          
            <span style="visibility: hidden; width: 0">|</span>
            <img src="/img/police_beian.png" srcset="/img/loading.gif" lazyload alt="police-icon"/>
          
          <span>赣ICP备20005950号-1</span>
        </a>
      </span>
    
  
</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
